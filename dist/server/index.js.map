{"version":3,"sources":["../../src/server/index.js"],"names":["upload","dest","app","DEV","process","env","NODE_ENV","webpack","require","webpackConfig","compiler","use","noInfo","publicPath","output","static","post","single","req","res","file","path","err","buffer","console","log","sendStatus","status","json","body","secret","toString","plaintext","server","listen","PORT","address","port"],"mappings":";;AAAA;;;;AACA;;;;AACA;;AACA;;AACA;;;;;;AAEA,MAAMA,SAAS,sBAAO,EAAEC,MAAM,UAAR,EAAP,CAAf;;AAEA,MAAMC,MAAM,wBAAZ;AACA,MAAMC,MAAMC,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,aAArC;;AAEA,IAAIH,GAAJ,EAAS;AACP,QAAMI,UAAUC,QAAQ,SAAR,CAAhB;AACA,QAAMC,gBAAgBD,QAAQ,sBAAR,GAAtB;AACA,QAAME,WAAWH,QAAQE,aAAR,CAAjB;;AAEAP,MAAIS,GAAJ,CAAQH,QAAQ,wBAAR,EAAkCE,QAAlC,EAA4C;AAClDE,YAAQ,IAD0C;AAElDC,gBAAYJ,cAAcK,MAAd,CAAqBD;AAFiB,GAA5C,CAAR;;AAKAX,MAAIS,GAAJ,CAAQH,QAAQ,wBAAR,EAAkCE,QAAlC,CAAR;AACD,CAXD,MAWO;AACLR,MAAIS,GAAJ,CAAQ,kBAAQI,MAAR,CAAe,QAAf,CAAR;AACD;;AAEDb,IAAIc,IAAJ,CAAS,WAAT,EAAsBhB,OAAOiB,MAAP,CAAc,WAAd,CAAtB,EAAkD,CAACC,GAAD,EAAMC,GAAN,KAAc;AAC9D,MAAID,IAAIE,IAAJ,IAAY,uBAAYF,IAAIE,IAAhB,CAAhB,EAAuC;AACrC,sBAASF,IAAIE,IAAJ,CAASC,IAAlB,EAAwB,CAACC,GAAD,EAAMC,MAAN,KAAiB;AACvC,UAAID,GAAJ,EAAS;AACPE,gBAAQC,GAAR,CAAYH,GAAZ;AACAH,YAAIO,UAAJ,CAAe,GAAf;AACA;AACD;AACDP,UAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,wBAASV,IAAIW,IAAJ,CAASC,MAAlB,EAA0BP,OAAOQ,QAAP,EAA1B,CAArB;AACD,KAPD;AAQD,GATD,MASO,IAAIb,IAAIW,IAAJ,CAASG,SAAb,EAAwB;AAC7Bb,QAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,wBAASV,IAAIW,IAAJ,CAASC,MAAlB,EAA0BZ,IAAIW,IAAJ,CAASG,SAAnC,CAArB;AACD,GAFM,MAEA;AACLb,QAAIO,UAAJ,CAAe,GAAf;AACD;AACF,CAfD;;AAiBA,MAAMO,SAAS/B,IAAIgC,MAAJ,CAAW9B,QAAQC,GAAR,CAAY8B,IAAZ,IAAoB,IAA/B,EAAqC,MAAM;AACxDX,UAAQC,GAAR,CAAa,+BAA8BQ,OAAOG,OAAP,GAAiBC,IAAK,EAAjE;AACD,CAFc,CAAf","file":"index.js","sourcesContent":["import express from 'express'\nimport multer from 'multer'\nimport { readFile } from 'fs'\nimport { isPlainFile } from '../util'\nimport playfair from './playfair'\n\nconst upload = multer({ dest: 'uploads/' })\n\nconst app = express()\nconst DEV = process.env.NODE_ENV === 'development'\n\nif (DEV) {\n  const webpack = require('webpack')\n  const webpackConfig = require('../../webpack.config')()\n  const compiler = webpack(webpackConfig)\n\n  app.use(require('webpack-dev-middleware')(compiler, {\n    noInfo: true,\n    publicPath: webpackConfig.output.publicPath,\n  }))\n\n  app.use(require('webpack-hot-middleware')(compiler))\n} else {\n  app.use(express.static('public'))\n}\n\napp.post('/playfair', upload.single('plaintext'), (req, res) => {\n  if (req.file && isPlainFile(req.file)) {\n    readFile(req.file.path, (err, buffer) => {\n      if (err) {\n        console.log(err)\n        res.sendStatus(500)\n        return\n      }\n      res.status(200).json(playfair(req.body.secret, buffer.toString()))\n    })\n  } else if (req.body.plaintext) {\n    res.status(200).json(playfair(req.body.secret, req.body.plaintext))\n  } else {\n    res.sendStatus(400)\n  }\n})\n\nconst server = app.listen(process.env.PORT || 3000, () => {\n  console.log(`Serving on http://localhost:${server.address().port}`)\n})\n"]}